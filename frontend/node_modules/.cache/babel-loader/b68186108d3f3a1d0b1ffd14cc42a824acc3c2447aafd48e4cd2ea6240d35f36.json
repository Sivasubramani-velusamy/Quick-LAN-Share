{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from 'react';\nimport SockJS from 'sockjs-client';\nimport { Client } from '@stomp/stompjs';\nconst useWebSocket = url => {\n  _s();\n  const client = useRef(null);\n  const [messages, setMessages] = useState([]);\n  const [connected, setConnected] = useState(false);\n  useEffect(() => {\n    client.current = new Client({\n      brokerURL: undefined,\n      webSocketFactory: () => new SockJS(url),\n      reconnectDelay: 5000,\n      debug: str => {\n        console.log(str);\n      }\n    });\n    client.current.onConnect = () => {\n      setConnected(true);\n      console.log('STOMP connected');\n      client.current.subscribe('/topic/progress', message => {\n        if (message.body) {\n          setMessages(prev => [...prev, message.body]);\n          console.log('Received message:', message.body);\n        }\n      });\n    };\n    client.current.onStompError = frame => {\n      setConnected(false);\n      console.error('STOMP error:', frame);\n    };\n    client.current.onWebSocketClose = () => {\n      setConnected(false);\n      console.log('STOMP disconnected');\n    };\n    client.current.activate();\n    return () => {\n      if (client.current) {\n        client.current.deactivate();\n      }\n    };\n  }, [url]);\n  const sendMessage = msg => {\n    if (client.current && client.current.connected) {\n      client.current.publish({\n        destination: '/app/progress',\n        body: msg\n      });\n    } else {\n      console.error('STOMP client is not connected');\n    }\n  };\n  return {\n    connected,\n    messages,\n    sendMessage\n  };\n};\n_s(useWebSocket, \"EScisWTPD4gMgqU7hIewul6rTwE=\");\nexport default useWebSocket;","map":{"version":3,"names":["useEffect","useRef","useState","SockJS","Client","useWebSocket","url","_s","client","messages","setMessages","connected","setConnected","current","brokerURL","undefined","webSocketFactory","reconnectDelay","debug","str","console","log","onConnect","subscribe","message","body","prev","onStompError","frame","error","onWebSocketClose","activate","deactivate","sendMessage","msg","publish","destination"],"sources":["C:/Users/sivas/My Project/QuickLAN/frontend/src/hooks/useWebSocket.js"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\r\nimport SockJS from 'sockjs-client';\r\nimport { Client } from '@stomp/stompjs';\r\n\r\nconst useWebSocket = (url) => {\r\n  const client = useRef(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [connected, setConnected] = useState(false);\r\n\r\n  useEffect(() => {\r\n    client.current = new Client({\r\n      brokerURL: undefined,\r\n      webSocketFactory: () => new SockJS(url),\r\n      reconnectDelay: 5000,\r\n      debug: (str) => {\r\n        console.log(str);\r\n      },\r\n    });\r\n\r\n    client.current.onConnect = () => {\r\n      setConnected(true);\r\n      console.log('STOMP connected');\r\n\r\n      client.current.subscribe('/topic/progress', (message) => {\r\n        if (message.body) {\r\n          setMessages((prev) => [...prev, message.body]);\r\n          console.log('Received message:', message.body);\r\n        }\r\n      });\r\n    };\r\n\r\n    client.current.onStompError = (frame) => {\r\n      setConnected(false);\r\n      console.error('STOMP error:', frame);\r\n    };\r\n\r\n    client.current.onWebSocketClose = () => {\r\n      setConnected(false);\r\n      console.log('STOMP disconnected');\r\n    };\r\n\r\n    client.current.activate();\r\n\r\n    return () => {\r\n      if (client.current) {\r\n        client.current.deactivate();\r\n      }\r\n    };\r\n  }, [url]);\r\n\r\n  const sendMessage = (msg) => {\r\n    if (client.current && client.current.connected) {\r\n      client.current.publish({ destination: '/app/progress', body: msg });\r\n    } else {\r\n      console.error('STOMP client is not connected');\r\n    }\r\n  };\r\n\r\n  return { connected, messages, sendMessage };\r\n};\r\n\r\nexport default useWebSocket;\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AACnD,OAAOC,MAAM,MAAM,eAAe;AAClC,SAASC,MAAM,QAAQ,gBAAgB;AAEvC,MAAMC,YAAY,GAAIC,GAAG,IAAK;EAAAC,EAAA;EAC5B,MAAMC,MAAM,GAAGP,MAAM,CAAC,IAAI,CAAC;EAC3B,MAAM,CAACQ,QAAQ,EAAEC,WAAW,CAAC,GAAGR,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACS,SAAS,EAAEC,YAAY,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EAEjDF,SAAS,CAAC,MAAM;IACdQ,MAAM,CAACK,OAAO,GAAG,IAAIT,MAAM,CAAC;MAC1BU,SAAS,EAAEC,SAAS;MACpBC,gBAAgB,EAAEA,CAAA,KAAM,IAAIb,MAAM,CAACG,GAAG,CAAC;MACvCW,cAAc,EAAE,IAAI;MACpBC,KAAK,EAAGC,GAAG,IAAK;QACdC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;MAClB;IACF,CAAC,CAAC;IAEFX,MAAM,CAACK,OAAO,CAACS,SAAS,GAAG,MAAM;MAC/BV,YAAY,CAAC,IAAI,CAAC;MAClBQ,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;MAE9Bb,MAAM,CAACK,OAAO,CAACU,SAAS,CAAC,iBAAiB,EAAGC,OAAO,IAAK;QACvD,IAAIA,OAAO,CAACC,IAAI,EAAE;UAChBf,WAAW,CAAEgB,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAEF,OAAO,CAACC,IAAI,CAAC,CAAC;UAC9CL,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEG,OAAO,CAACC,IAAI,CAAC;QAChD;MACF,CAAC,CAAC;IACJ,CAAC;IAEDjB,MAAM,CAACK,OAAO,CAACc,YAAY,GAAIC,KAAK,IAAK;MACvChB,YAAY,CAAC,KAAK,CAAC;MACnBQ,OAAO,CAACS,KAAK,CAAC,cAAc,EAAED,KAAK,CAAC;IACtC,CAAC;IAEDpB,MAAM,CAACK,OAAO,CAACiB,gBAAgB,GAAG,MAAM;MACtClB,YAAY,CAAC,KAAK,CAAC;MACnBQ,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;IACnC,CAAC;IAEDb,MAAM,CAACK,OAAO,CAACkB,QAAQ,CAAC,CAAC;IAEzB,OAAO,MAAM;MACX,IAAIvB,MAAM,CAACK,OAAO,EAAE;QAClBL,MAAM,CAACK,OAAO,CAACmB,UAAU,CAAC,CAAC;MAC7B;IACF,CAAC;EACH,CAAC,EAAE,CAAC1B,GAAG,CAAC,CAAC;EAET,MAAM2B,WAAW,GAAIC,GAAG,IAAK;IAC3B,IAAI1B,MAAM,CAACK,OAAO,IAAIL,MAAM,CAACK,OAAO,CAACF,SAAS,EAAE;MAC9CH,MAAM,CAACK,OAAO,CAACsB,OAAO,CAAC;QAAEC,WAAW,EAAE,eAAe;QAAEX,IAAI,EAAES;MAAI,CAAC,CAAC;IACrE,CAAC,MAAM;MACLd,OAAO,CAACS,KAAK,CAAC,+BAA+B,CAAC;IAChD;EACF,CAAC;EAED,OAAO;IAAElB,SAAS;IAAEF,QAAQ;IAAEwB;EAAY,CAAC;AAC7C,CAAC;AAAC1B,EAAA,CAvDIF,YAAY;AAyDlB,eAAeA,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}