{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{Box,TextField,Button,Typography,Paper,InputAdornment,MenuItem,CircularProgress,Popper,List,ListItem,ListItemButton,ListItemText,ClickAwayListener,IconButton}from'@mui/material';import LanIcon from'@mui/icons-material/Lan';import DnsIcon from'@mui/icons-material/Dns';import ArrowDropDownIcon from'@mui/icons-material/ArrowDropDown';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ConnectionForm=_ref=>{let{onConnect}=_ref;const[ip,setIp]=useState('');const[port,setPort]=useState(9090);const[error,setError]=useState('');const[availableDevices,setAvailableDevices]=useState([]);const[loading,setLoading]=useState(false);const[dropdownOpen,setDropdownOpen]=useState(false);const anchorRef=useRef(null);const validateIP=ip=>{const ipRegex=/^(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){2}(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/;return ipRegex.test(ip);};const fetchAvailableDevices=async()=>{setLoading(true);try{const response=await fetch('http://localhost:9092/api/discover-receivers');if(response.ok){try{const devices=await response.json();console.log('Devices:',devices);setAvailableDevices(devices);}catch(jsonError){const text=await response.text();console.error('Failed to parse JSON. Response text:',text);setAvailableDevices([]);}}else{console.error('HTTP error fetching devices:',response.status);setAvailableDevices([]);}}catch(err){console.error('Fetch error:',err);setAvailableDevices([]);}setLoading(false);};useEffect(()=>{if(dropdownOpen)fetchAvailableDevices();},[dropdownOpen]);const handleConnect=()=>{if(!validateIP(ip)){setError('Invalid IP address');return;}setError('');onConnect(ip,port);};const handleSelectDevice=device=>{setIp(device);setDropdownOpen(false);setError('');};return/*#__PURE__*/_jsxs(Paper,{sx:{p:4,maxWidth:400,margin:'auto',mt:6,boxShadow:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,textAlign:\"center\",children:\"Connect to Receiver\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexDirection:'column',gap:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(TextField,{label:\"Receiver IP\",value:ip,onChange:e=>setIp(e.target.value),error:!!error,helperText:error,fullWidth:true,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(LanIcon,{})}),endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(IconButton,{ref:anchorRef,onClick:()=>setDropdownOpen(!dropdownOpen),children:/*#__PURE__*/_jsx(ArrowDropDownIcon,{})})})}}),/*#__PURE__*/_jsx(Popper,{open:dropdownOpen,anchorEl:anchorRef.current,placement:\"bottom-start\",style:{zIndex:1300},children:/*#__PURE__*/_jsx(ClickAwayListener,{onClickAway:()=>setDropdownOpen(false),children:/*#__PURE__*/_jsx(Paper,{sx:{maxHeight:200,overflowY:'auto',width:300},children:loading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',p:2},children:/*#__PURE__*/_jsx(CircularProgress,{size:24})}):availableDevices.length===0?/*#__PURE__*/_jsx(Typography,{sx:{p:2},children:\"No devices found.\"}):/*#__PURE__*/_jsx(List,{dense:true,children:availableDevices.map(device=>/*#__PURE__*/_jsx(ListItem,{disablePadding:true,children:/*#__PURE__*/_jsx(ListItemButton,{onClick:()=>handleSelectDevice(device),children:/*#__PURE__*/_jsx(ListItemText,{primary:device})})},device))})})})})]}),/*#__PURE__*/_jsx(TextField,{label:\"Port\",type:\"number\",value:port,onChange:e=>setPort(Number(e.target.value)),fullWidth:true,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(DnsIcon,{})})}}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"large\",onClick:handleConnect,disabled:!ip||!port,children:\"Connect\"})]})]});};export default ConnectionForm;","map":{"version":3,"names":["React","useState","useEffect","useRef","Box","TextField","Button","Typography","Paper","InputAdornment","MenuItem","CircularProgress","Popper","List","ListItem","ListItemButton","ListItemText","ClickAwayListener","IconButton","LanIcon","DnsIcon","ArrowDropDownIcon","jsx","_jsx","jsxs","_jsxs","ConnectionForm","_ref","onConnect","ip","setIp","port","setPort","error","setError","availableDevices","setAvailableDevices","loading","setLoading","dropdownOpen","setDropdownOpen","anchorRef","validateIP","ipRegex","test","fetchAvailableDevices","response","fetch","ok","devices","json","console","log","jsonError","text","status","err","handleConnect","handleSelectDevice","device","sx","p","maxWidth","margin","mt","boxShadow","children","variant","gutterBottom","textAlign","display","flexDirection","gap","alignItems","label","value","onChange","e","target","helperText","fullWidth","InputProps","startAdornment","position","endAdornment","ref","onClick","open","anchorEl","current","placement","style","zIndex","onClickAway","maxHeight","overflowY","width","justifyContent","size","length","dense","map","disablePadding","primary","type","Number","disabled"],"sources":["C:/Users/sivas/My Project/QuickLAN/frontend/src/components/ConnectionForm.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport {\r\n  Box,\r\n  TextField,\r\n  Button,\r\n  Typography,\r\n  Paper,\r\n  InputAdornment,\r\n  MenuItem,\r\n  CircularProgress,\r\n  Popper,\r\n  List,\r\n  ListItem,\r\n  ListItemButton,\r\n  ListItemText,\r\n  ClickAwayListener,\r\n  IconButton\r\n} from '@mui/material';\r\nimport LanIcon from '@mui/icons-material/Lan';\r\nimport DnsIcon from '@mui/icons-material/Dns';\r\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown';\r\n\r\nconst ConnectionForm = ({ onConnect }) => {\r\n  const [ip, setIp] = useState('');\r\n  const [port, setPort] = useState(9090);\r\n  const [error, setError] = useState('');\r\n  const [availableDevices, setAvailableDevices] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [dropdownOpen, setDropdownOpen] = useState(false);\r\n  const anchorRef = useRef(null);\r\n\r\n  const validateIP = (ip) => {\r\n    const ipRegex = /^(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.((25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){2}(25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/;\r\n    return ipRegex.test(ip);\r\n  };\r\n\r\n  const fetchAvailableDevices = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await fetch('http://localhost:9092/api/discover-receivers');\r\n      if (response.ok) {\r\n        try {\r\n          const devices = await response.json();\r\n          console.log('Devices:', devices);\r\n          setAvailableDevices(devices);\r\n        } catch (jsonError) {\r\n          const text = await response.text();\r\n          console.error('Failed to parse JSON. Response text:', text);\r\n          setAvailableDevices([]);\r\n        }\r\n      } else {\r\n        console.error('HTTP error fetching devices:', response.status);\r\n        setAvailableDevices([]);\r\n      }\r\n    } catch (err) {\r\n      console.error('Fetch error:', err);\r\n      setAvailableDevices([]);\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (dropdownOpen) fetchAvailableDevices();\r\n  }, [dropdownOpen]);\r\n\r\n  const handleConnect = () => {\r\n    if (!validateIP(ip)) {\r\n      setError('Invalid IP address');\r\n      return;\r\n    }\r\n    setError('');\r\n    onConnect(ip, port);\r\n  };\r\n\r\n  const handleSelectDevice = (device) => {\r\n    setIp(device);\r\n    setDropdownOpen(false);\r\n    setError('');\r\n  };\r\n\r\n  return (\r\n    <Paper sx={{ p: 4, maxWidth: 400, margin: 'auto', mt: 6, boxShadow: 3 }}>\r\n      <Typography variant=\"h5\" gutterBottom textAlign=\"center\">\r\n        Connect to Receiver\r\n      </Typography>\r\n\r\n      <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n        <Box sx={{ display: 'flex', alignItems: 'center' }}>\r\n          <TextField\r\n            label=\"Receiver IP\"\r\n            value={ip}\r\n            onChange={(e) => setIp(e.target.value)}\r\n            error={!!error}\r\n            helperText={error}\r\n            fullWidth\r\n            InputProps={{\r\n              startAdornment: (\r\n                <InputAdornment position=\"start\">\r\n                  <LanIcon />\r\n                </InputAdornment>\r\n              ),\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton ref={anchorRef} onClick={() => setDropdownOpen(!dropdownOpen)}>\r\n                    <ArrowDropDownIcon />\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              ),\r\n            }}\r\n          />\r\n          <Popper open={dropdownOpen} anchorEl={anchorRef.current} placement=\"bottom-start\" style={{ zIndex: 1300 }}>\r\n            <ClickAwayListener onClickAway={() => setDropdownOpen(false)}>\r\n              <Paper sx={{ maxHeight: 200, overflowY: 'auto', width: 300 }}>\r\n                {loading ? (\r\n                  <Box sx={{ display: 'flex', justifyContent: 'center', p: 2 }}>\r\n                    <CircularProgress size={24} />\r\n                  </Box>\r\n                ) : availableDevices.length === 0 ? (\r\n                  <Typography sx={{ p: 2 }}>No devices found.</Typography>\r\n                ) : (\r\n                  <List dense>\r\n                    {availableDevices.map((device) => (\r\n                      <ListItem key={device} disablePadding>\r\n                        <ListItemButton onClick={() => handleSelectDevice(device)}>\r\n                          <ListItemText primary={device} />\r\n                        </ListItemButton>\r\n                      </ListItem>\r\n                    ))}\r\n                  </List>\r\n                )}\r\n              </Paper>\r\n            </ClickAwayListener>\r\n          </Popper>\r\n        </Box>\r\n\r\n        <TextField\r\n          label=\"Port\"\r\n          type=\"number\"\r\n          value={port}\r\n          onChange={(e) => setPort(Number(e.target.value))}\r\n          fullWidth\r\n          InputProps={{\r\n            startAdornment: (\r\n              <InputAdornment position=\"start\">\r\n                <DnsIcon />\r\n              </InputAdornment>\r\n            ),\r\n          }}\r\n        />\r\n\r\n        <Button variant=\"contained\" size=\"large\" onClick={handleConnect} disabled={!ip || !port}>\r\n          Connect\r\n        </Button>\r\n      </Box>\r\n    </Paper>\r\n  );\r\n};\r\n\r\nexport default ConnectionForm;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}